(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-order-order"],{"121d":function(e,t,n){"use strict";var r=n("4ea4");n("99af"),n("4160"),n("e25e"),n("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("2909")),i=r(n("5530"));n("96cf");var o=r(n("1da1")),s=r(n("a874")),u=r(n("7b90")),c=n("75a1"),d=r(n("d409")),l=n("893c"),h=r(n("c966")),v={components:{rfLoadMore:s.default,rfCountDown:d.default},data:function(){return{tabCurrentIndex:null,loadingType:"more",navList:this.$mConstDataConfig.orderNavList,moneySymbol:this.moneySymbol,orderList:[],page:1,loading:!0,isRefreshing:!0,guessYouLikeList:[],singleSkuText:this.singleSkuText}},computed:{second:function(){return function(e){return Math.floor(e-new Date/1e3)}}},filters:{time:function(e){return(0,u.default)(1e3*e).format("YYYY-MM-DD HH:mm:ss")},orderStatusFilter:function(e){var t;return h.default.orderStatus.forEach((function(n){n.key===parseInt(e,10)&&(t=n.value)})),t}},onShow:function(){this.initData()},onLoad:function(e){this.tabCurrentIndex=parseInt(e.state,10)+1},onPullDownRefresh:function(){this.page=1,this.orderList.length=0,this.getOrderList("refresh")},onReachBottom:function(){"nomore"!==this.loadingType&&0!==this.orderList.length&&(this.page++,this.getOrderList())},methods:{timeUp:function(e){this.isRefreshing&&(this.isRefreshing=!1,this.handleOrderClose(e.id))},handleOrderOperation:function(e,t){switch(t){case"detail":this.navTo("/pages/order/detail?id=".concat(e.id));break;case"evaluation":this.navTo("/pages/order/evaluation/evaluation?order_id=".concat(e.id));break;case"close":this.handleOrderClose(e.id);break;case"delete":this.handleOrderDelete(e.id);break;case"shipping":this.navTo("/pages/order/shipping/shipping?id=".concat(e.id));break;case"delivery":this.handleOrderTakeDelivery(e.id);break}},navTo:function(e){this.$mRouter.push({route:e})},handleOrderClose:function(e){var t=this;return(0,o.default)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$http.get("".concat(l.orderClose),{id:e}).then((function(){t.isRefreshing=!0,t.$mHelper.toast("订单取消成功"),setTimeout((function(){t.loading=!0,t.page=1,t.orderList.length=0,t.getOrderList()}),500)}));case 2:case"end":return n.stop()}}),n)})))()},handleOrderDelete:function(e){var t=this;return(0,o.default)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$http.delete("".concat(c.orderDelete,"?id=").concat(e),{}).then((function(){t.$mHelper.toast("订单删除成功"),setTimeout((function(){t.page=1,t.orderList.length=0,t.getOrderList()}),500)}));case 2:case"end":return n.stop()}}),n)})))()},handleOrderTakeDelivery:function(e){var t=this;return(0,o.default)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$http.get("".concat(c.orderTakeDelivery),{id:e}).then((function(){t.page=1,t.orderList.length=0,t.getOrderList()}));case 2:case"end":return n.stop()}}),n)})))()},initData:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.page=1,e.orderList.length=0,t.next=4,e.getOrderList();case 4:case"end":return t.stop()}}),t)})))()},getOrderList:function(e){var t=this;return(0,o.default)(regeneratorRuntime.mark((function n(){var r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.navList[t.tabCurrentIndex],s={},r.state||0===r.state?s.status=r.state:s.status=-1,s.pageNum=t.page,n.next=6,t.$http.get("".concat(c.orderList),(0,i.default)((0,i.default)({},s),{},{pageSize:10})).then(function(){var n=(0,o.default)(regeneratorRuntime.mark((function n(r){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if("refresh"===e&&uni.stopPullDownRefresh(),t.loadingType=10===r.data.length?"more":"nomore",t.orderList=[].concat((0,a.default)(t.orderList),(0,a.default)(r.data)),0!==t.orderList.length){n.next=6;break}return n.next=6,t.getGuessYouLikeList();case 6:t.loading=!1;case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(){t.loading=!1,"refresh"===e&&uni.stopPullDownRefresh()}));case 6:case"end":return n.stop()}}),n)})))()},getGuessYouLikeList:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("".concat(l.guessYouLikeList)).then((function(t){e.guessYouLikeList=t.data}));case 2:case"end":return t.stop()}}),t)})))()},changeTab:function(e){this.page=1,this.orderList.length=0,this.tabCurrentIndex=e.target.current,this.loading=!0,this.getOrderList()},tabClick:function(e){this.page=1,this.orderList.length=0,this.tabCurrentIndex=e,this.loading=!0,this.getOrderList()},getMoreOrderList:function(){"nomore"!==this.loadingType&&0!==this.orderList.length&&(this.page++,this.getOrderList())}}};t.default=v},"9d59":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r}));var r={rfLoadMore:n("a874").default},a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"order"},[n("v-uni-view",{staticClass:"navbar"},e._l(e.navList,(function(t,r){return n("v-uni-view",{key:r,staticClass:"nav-item",class:e.tabCurrentIndex===r?"text-"+e.themeColor.name+" current":"",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.tabClick(r)}}},[e._v(e._s(t.text))])})),1),n("v-uni-swiper",{staticClass:"swiper-box",attrs:{duration:"300"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.changeTab.apply(void 0,arguments)}}},e._l(e.navList,(function(t,r){return n("v-uni-swiper-item",{key:r,staticClass:"tab-content"},[n("v-uni-scroll-view",{staticClass:"list-scroll-content",attrs:{"scroll-y":!0},on:{scrolltolower:function(t){arguments[0]=t=e.$handleEvent(t),e.getMoreOrderList.apply(void 0,arguments)}}},[e._l(e.orderList,(function(t,r){return n("v-uni-view",{key:r,staticClass:"rf-order-item"},[n("v-uni-view",{staticClass:"i-top b-b"},[n("v-uni-text",{staticClass:"time in1line"},[e._v("订单号："+e._s(t.order_sn))]),0!==parseInt(t.order_status,10)?n("v-uni-text",{staticClass:"state",class:"text-"+e.themeColor.name},[e._v(e._s(e._f("orderStatusFilter")(t.order_status)))]):n("v-uni-view",{staticClass:"example-body"},[n("rf-count-down",{attrs:{"show-day":!1,second:e.second(t.close_time),color:"#FFFFFF","background-color":e.themeColor.color,"border-color":e.themeColor.color},on:{timeup:function(n){arguments[0]=n=e.$handleEvent(n),e.timeUp(t)}}})],1)],1),e._l(t.product,(function(r,a){return n("v-uni-view",{key:a,staticClass:"goods-box-single",on:{click:function(n){n.stopPropagation(),arguments[0]=n=e.$handleEvent(n),e.navTo("/pages/order/detail?id="+t.id)}}},[n("v-uni-image",{staticClass:"goods-img",attrs:{src:r.product_pic,mode:"aspectFill"}}),n("v-uni-view",{staticClass:"right"},[n("v-uni-text",{staticClass:"title in2line"},[e._v(e._s(r.product_name))]),n("v-uni-text",{staticClass:"attr-box"},[e._v(e._s(r.sku_name||e.singleSkuText)+" * "+e._s(r.num))]),2==r.point_exchange_type?n("v-uni-text",[n("v-uni-text",{staticClass:"point",class:"text-"+e.themeColor.name},[e._v(e._s(r.product_money)+" + "+e._s(t.point)+"积分")])],1):4==r.point_exchange_type?n("v-uni-text",[n("v-uni-text",{staticClass:"point"},[e._v(e._s(t.point)+"积分")])],1):n("v-uni-text",{staticClass:"price"},[n("v-uni-text",{class:"text-"+e.themeColor.name},[e._v(e._s(e.moneySymbol)+e._s(r.product_money)),0===r.gift_flag?n("v-uni-text",[e._v("+ "+e._s(t.point+"积分"||!1))]):e._e()],1)],1)],1)],1)})),n("v-uni-view",{staticClass:"price-box"},[e._v("共"),n("v-uni-text",{staticClass:"num"},[e._v(e._s(t.product_count))]),e._v("件商品 实付款"),n("v-uni-text",{staticClass:"price",class:"text-"+e.themeColor.name},[e._v(e._s(e.moneySymbol)+e._s(t.pay_money))])],1),n("v-uni-view",{staticClass:"action-box b-t"},[0==t.order_status?n("v-uni-button",{staticClass:"action-btn",class:"text-"+e.themeColor.name,on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.handleOrderOperation(t,"close")}}},[e._v("取消订单")]):e._e(),4!=t.order_status&&2!=t.order_status||1==t.product[0].is_virtual?e._e():n("v-uni-button",{staticClass:"action-btn",class:"text-"+e.themeColor.name,on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.handleOrderOperation(t,"shipping")}}},[e._v("查看物流")]),-4==t.order_status?n("v-uni-button",{staticClass:"action-btn",class:"text-"+e.themeColor.name,on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.handleOrderOperation(t,"delete")}}},[e._v("删除订单")]):e._e(),n("v-uni-button",{staticClass:"action-btn",class:"bg-"+e.themeColor.name,on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.handleOrderOperation(t,"detail")}}},[e._v("订单详情")]),0==t.order_status||202==t.order_status?n("v-uni-button",{staticClass:"action-btn",class:"bg-"+e.themeColor.name,on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.navTo("/pages/user/money/pay?id="+t.id)}}},[e._v("立即支付")]):e._e(),3!=t.order_status&&4!=t.order_status||0!=t.is_evaluate?e._e():n("v-uni-button",{staticClass:"action-btn",class:"bg-"+e.themeColor.name,on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.handleOrderOperation(t,"evaluation")}}},[e._v("批量评价")]),2==t.order_status?n("v-uni-button",{staticClass:"action-btn",class:"bg-"+e.themeColor.name,on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.handleOrderOperation(t,"delivery")}}},[e._v("确认收货")]):e._e()],1)],2)})),e.orderList.length>0?n("rf-load-more",{attrs:{status:e.loadingType}}):e._e(),0!==e.orderList.length||e.loading?e._e():n("rf-empty",{attrs:{list:e.guessYouLikeList,info:"暂无订单"}})],2)],1)})),1),n("rfLoading",{attrs:{isFullScreen:!0,active:e.loading}})],1)},i=[]},b988:function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,'@charset "UTF-8";\n/* 页面左右间距 */\n/* 文字尺寸 */\n/*文字颜色*/\n/* 边框颜色 */\n/* 图片加载中颜色 */\n/* 行为相关颜色 */uni-page-body[data-v-51b7e95e],\n.order[data-v-51b7e95e]{background:#f8f8f8;height:100%}uni-page-body .order-search[data-v-51b7e95e],\n.order .order-search[data-v-51b7e95e]{padding:%?10?% %?20?%;position:relative}uni-page-body .order-search .order-search-input[data-v-51b7e95e],\n.order .order-search .order-search-input[data-v-51b7e95e]{width:100%;background-color:#fff;-webkit-border-radius:%?40?%;border-radius:%?40?%;padding:%?10?% 0 %?10?% %?30?%;color:#909399}uni-page-body .order-search .iconfont[data-v-51b7e95e],\n.order .order-search .iconfont[data-v-51b7e95e]{position:absolute;right:%?48?%;top:%?22?%}uni-page-body .swiper-box[data-v-51b7e95e],\n.order .swiper-box[data-v-51b7e95e]{height:calc(100% - %?160?%)}uni-page-body .list-scroll-content[data-v-51b7e95e],\n.order .list-scroll-content[data-v-51b7e95e]{height:100%}uni-page-body .uni-swiper-item[data-v-51b7e95e],\n.order .uni-swiper-item[data-v-51b7e95e]{height:auto}body.?%PAGE?%[data-v-51b7e95e]{background:#f8f8f8}',""]),e.exports=t},b9ed:function(e,t,n){"use strict";n.r(t);var r=n("9d59"),a=n("c35d");for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);n("e6b4");var o,s=n("f0c5"),u=Object(s["a"])(a["default"],r["b"],r["c"],!1,null,"51b7e95e",null,!1,r["a"],o);t["default"]=u.exports},c35d:function(e,t,n){"use strict";n.r(t);var r=n("121d"),a=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t["default"]=a.a},e6b4:function(e,t,n){"use strict";var r=n("fbae"),a=n.n(r);a.a},fbae:function(e,t,n){var r=n("b988");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var a=n("4f06").default;a("4b2b09c4",r,!0,{sourceMap:!1,shadowMode:!1})}}]);